{% import "macros/icon.html" as icon %}
{% import "macros/transform.html" as transform %}
{% import "macros/generate.html" as gen %}

{% extends "base.html" %}

{% block header %}
  <figure class="header-video">
    <video playsinline muted loop width="100%" height="100%">
      <source src="veloren.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </figure>
{% endblock header %}

{% block content %}
  <section class="post">
    <article>
      {% set page = get_page(path="home.md") %}
      {{ page.content | safe }}
    </article>
  </section>
  <section class="post">
    <article>
      <div class="posts">
        <h2>Latest development updates</h2>
        {% set cats = get_taxonomy(kind="tags") %}
        {% set show_posts = 3 %}
        {% for cat in cats.items %}
          {% if cat.name == "devblog" %}
            {% for page in cat.pages %}
              {% if show_posts > 0 and page.date %}
                {% set_global show_posts = show_posts - 1 %}
                {{ gen::post_preview(page=page) }}
              {% endif %}
            {% endfor %}
          {% endif %}
        {% endfor %}
        <section>
          {# We could link to the auto-generated taxonomy at /tags/devblogs/, but /devblogs/ is a much nicer url. #}
          {# <a class="header-link" href="{{get_taxonomy_url(kind="tags", name="devblog")}}"> #}
            <a class="header-link" href="{{ get_url(path="@/devblogs.md") }}">Read older posts...
          </a>
        </section>
      </div>
    </article>
  </section>
{% endblock content %}